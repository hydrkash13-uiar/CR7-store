<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SOMA Store</title>
<style>
  /* (Ø§Ø­ØªÙØ¸ Ø¨Ù†ÙØ³ CSS Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ø³ÙŠØ·Ø©) */
  body{margin:0;background:#0d0d0d;color:#fff;font-family:Tajawal, sans-serif}
  header{background:#000;color:#ffd700;padding:10px;text-align:center;font-weight:bold;border-bottom:2px solid #ffd700}
  .logo{font-size:22px}
  .menu-toggle{position:fixed;top:10px;right:10px;background:#ffd700;border:none;padding:8px;border-radius:6px}
  .menu{position:fixed;top:0;right:-300px;width:280px;height:100%;background:#111;padding-top:60px;transition:.25s;z-index:100}
  .menu.open{right:0}
  .menu a{display:block;padding:12px;color:#ddd;text-decoration:none;border-bottom:1px solid #222}
  .banner{padding:12px;text-align:center}
  .search{padding:12px;text-align:center}
  .sections{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:12px}
  .section{background:#1a1a1a;border-radius:10px;padding:10px;text-align:center}
  .auth{display:flex;gap:8px;justify-content:center;margin:10px}
  input,button,select{padding:8px;border-radius:8px;border:none}
  .small{color:#9aa0a6;font-size:13px}
</style>
</head>
<body>
<header><div class="logo">SOMA STORE</div></header>
<button class="menu-toggle" id="menuBtn">â˜°</button>

<!-- sidebar -->
<div class="menu" id="menu">
  <div style="padding:12px;color:#ffd700;font-weight:700">Ø­Ø³Ø§Ø¨Ùƒ</div>
  <div id="userBox" style="padding:12px;border-bottom:1px solid #222">
    <div id="uName" style="font-weight:700">Ø²Ø§Ø¦Ø±</div>
    <div class="small" id="uSerial">#----</div>
    <div style="margin-top:8px;font-weight:800;color:#ffd700" id="uBalance">$0</div>
  </div>

  <a href="#" onclick="openRegister()">ØªØ³Ø¬ÙŠÙ„</a>
  <a href="#" onclick="openLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</a>
  <a href="#" onclick="openTopup()">ğŸ’° Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯</a>
  <a href="#" onclick="openOrders()">ğŸ›’ Ø·Ù„Ø¨Ø§ØªÙŠ</a>
  <a href="#" onclick="openWallet()">ğŸ’¼ Ù…Ø­ÙØ¸ØªÙŠ</a>
  <a href="#" onclick="openAgents()">ğŸ¤ ÙˆÙƒÙ„Ø§Ø¤Ù†Ø§</a>
  <a href="#" onclick="openProtection()">ğŸ›¡ï¸ Ø§Ù„Ø­Ù…Ø§ÙŠØ©</a>
  <a href="#" onclick="openAbout()">â„¹ï¸ Ù…Ù† Ù†Ø­Ù†</a>

  <div style="padding:12px;border-top:1px solid #222">
    Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† <input type="checkbox" checked/>
  </div>
</div>

<div class="banner">
  <img src="https://i.imgur.com/E4yRkBv.png" style="width:95%;border-radius:8px"/>
</div>

<div class="auth">
  <div><button onclick="openRegister()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button></div>
  <div><button onclick="openLogin()">Ø¯Ø®ÙˆÙ„</button></div>
</div>

<div class="search">
  <input id="q" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ØªØ·Ø¨ÙŠÙ‚ Ø£Ùˆ Ø±ØµÙŠØ¯..." style="width:85%;background:#1a1a1a;color:#fff;border-radius:8px;padding:10px"/>
</div>

<div class="sections" id="sections">
  <div class="section"><img src="https://i.imgur.com/dHgE1eY.png" style="width:100%;border-radius:8px"/><h3>Ù‚Ø³Ù… Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</h3></div>
  <div class="section"><img src="https://i.imgur.com/Y1fP5f3.png" style="width:100%;border-radius:8px"/><h3>Ù‚Ø³Ù… Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</h3></div>
  <div class="section"><img src="https://i.imgur.com/8byZsHS.png" style="width:100%;border-radius:8px"/><h3>Ù‚Ø³Ù… Ø§Ù„Ø£Ø±ØµØ¯Ø©</h3></div>
</div>

<!-- modal area -->
<div id="modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:200">
  <div style="background:#0b0b0b;padding:14px;border-radius:10px;max-width:420px;margin:auto">
    <div id="modalBody"></div>
    <div style="text-align:left;margin-top:10px"><button onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button></div>
  </div>
</div>

<script>
  // API base - Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Ø¯Ù… Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ù†Ø´Ø±Ù‡ (Ù…Ø«Ù„Ø§Ù‹ https://your-app.onrender.com)
  const API_BASE = 'https://YOUR_BACKEND_URL_HERE'; // <-- ØºÙŠÙ‘Ø± Ù‡Ø°Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø´Ø±

  const menu = document.getElementById('menu');
  document.getElementById('menuBtn').addEventListener('click', ()=> menu.classList.toggle('open'));

  // modal helpers
  function openModal(html){ document.getElementById('modalBody').innerHTML = html; document.getElementById('modal').style.display='flex'; }
  function closeModal(){ document.getElementById('modal').style.display='none'; }

  // register/login UI
  function openRegister(){
    openModal(`<h3>ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨</h3>
      <input id="r_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¶" style="width:100%;margin:6px 0"/><br/>
      <input id="r_user" placeholder="Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" style="width:100%;margin:6px 0"/><br/>
      <input id="r_pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" style="width:100%;margin:6px 0"/><br/>
      <button onclick="doRegister()">ØªØ³Ø¬ÙŠÙ„</button>`);
  }
  async function doRegister(){
    const name = document.getElementById('r_name').value.trim();
    const user = document.getElementById('r_user').value.trim();
    const pass = document.getElementById('r_pass').value.trim();
    if(!name||!user||!pass) return alert('Ø§ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„');
    const res = await fetch(API_BASE + '/api/register', {
      method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({display_name:name, username:user, password:pass})
    });
    const data = await res.json();
    if(!data.ok) return alert('Ø®Ø·Ø£: '+(data.error||''));
    localStorage.setItem('soma_token', data.token);
    setUserUI(data.user);
    closeModal();
    alert('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„');
  }

  function openLogin(){
    openModal(`<h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</h3>
      <input id="l_user" placeholder="Ø§Ù„Ù…Ø¹Ø±Ù" style="width:100%;margin:6px 0"/><br/>
      <input id="l_pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" style="width:100%;margin:6px 0"/><br/>
      <button onclick="doLogin()">Ø¯Ø®ÙˆÙ„</button>`);
  }
  async function doLogin(){
    const user = document.getElementById('l_user').value.trim();
    const pass = document.getElementById('l_pass').value.trim();
    if(!user||!pass) return alert('Ø§ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„');
    const res = await fetch(API_BASE + '/api/login', {
      method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({username:user, password:pass})
    });
    const data = await res.json();
    if(!data.ok) return alert('Ø®Ø·Ø£: '+(data.error||''));
    localStorage.setItem('soma_token', data.token);
    setUserUI(data.user);
    closeModal();
    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
  }

  // set UI
  function setUserUI(user){
    if(!user) return;
    document.getElementById('uName').textContent = user.display_name || user.username;
    document.getElementById('uSerial').textContent = '#' + (user.serial || '----');
    document.getElementById('uBalance').textContent = '$' + (user.balance || 0);
  }

  async function loadMe(){
    const token = localStorage.getItem('soma_token');
    if(!token) return;
    const res = await fetch(API_BASE + '/api/me', { headers: { Authorization: 'Bearer ' + token }});
    if(!res.ok){ console.log('not logged'); return; }
    const data = await res.json();
    if(data.ok) setUserUI(data.user);
  }

  // orders/topup examples
  function openTopup(){
    openModal(`<h3>Ø·Ù„Ø¨ Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯</h3>
      <input id="tp_amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" style="width:100%;margin:6px 0"/><br/>
      <select id="tp_method" style="width:100%;margin:6px 0"><option value="transfer">ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ</option><option value="paypal">Paypal</option></select>
      <button onclick="doTopup()">Ø£Ø±Ø³Ù„ Ø·Ù„Ø¨</button>`);
  }
  async function doTopup(){
    const amount = parseFloat(document.getElementById('tp_amount').value || 0);
    const method = document.getElementById('tp_method').value;
    if(!amount || amount<=0) return alert('Ø§Ù„Ù…Ø¨Ù„Øº ØºÙŠØ± ØµØ§Ù„Ø­');
    const token = localStorage.getItem('soma_token');
    if(!token) return alert('Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
    const res = await fetch(API_BASE + '/api/topup', {
      method:'POST', headers:{'Content-Type':'application/json', 'Authorization':'Bearer ' + token},
      body: JSON.stringify({amount, method})
    });
    const data = await res.json();
    if(data.ok) { alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±ØµÙŠØ¯'); closeModal(); }
    else alert('Ø®Ø·Ø£: ' + (data.error||''));
  }

  // init
  loadMe();
</script>
</body>
  </html>
